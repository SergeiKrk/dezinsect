---
import ServiceSidebar from "@components/uslugi/ServiceSidebar.astro";
import ServicePageBanner from "@components/features/ServicePageBanner.astro";
import Shape from "@components/Shape.astro";
import Base from "@layouts/Base.astro";
import { getSinglePage } from "@lib/contentParser.astro";
import similerItems from "@lib/utils/similarItems";
import { getEntryBySlug } from "astro:content";

const uslugiIndex: any = await getEntryBySlug("uslugi", "-index");
const uslugipages = await getSinglePage("uslugi");
export async function getStaticPaths() {
  const uslugipages = await getSinglePage("uslugi");
  const paths = uslugipages.map((post) => ({
    params: {
      single: post.slug,
    },
    props: { post },
  }));
  return paths;
}
const { post } = Astro.props;
const { Content } = await post.render();
const similarPosts = similerItems(post, uslugipages, post.slug);
const page_data = {
  index_title: uslugiIndex.data.title,
  description: post.data.description,
  minPric: post.data.minPric,
  imgBanner: post.data.imgBanner,
  serviceIcon: post.data.serviceIcon,
  altserviceIcon: post.data.altserviceIcon,
  page_title: post.data.title,
  slug: post.slug,
};
---

<Base
  title={post.data.title}
  meta_title={post.data.meta_title}
  description={post.data.description}
  image={post.data.image}
>
  <Shape />
  <ServicePageBanner page_data={page_data} />
  <section class="section career-single pt-0">
    <div class="container">
      <div class="lg:gx-4 row">
        <div class="lg:col-8">
          <div
            class="content rounded-xl bg-white p-7 shadow-lg lg:px-12 lg:py-[60px]"
          >
            <Content />
          </div>
        </div>
        <ServiceSidebar
          posts={similarPosts[0]}
          sidebar_content={uslugiIndex.data.sidebar_content}
        />
      </div>
    </div>
  </section>
</Base>
